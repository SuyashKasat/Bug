(this["webpackJsonpbugtrail-v3"]=this["webpackJsonpbugtrail-v3"]||[]).push([[0],{33:function(e,t,a){e.exports=a(62)},38:function(e,t,a){},46:function(e,t,a){},51:function(e,t,a){},52:function(e,t,a){},53:function(e,t,a){},54:function(e,t,a){},55:function(e,t,a){},56:function(e,t,a){},57:function(e,t,a){},58:function(e,t,a){},62:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),c=a(30),r=a.n(c),o=(a(38),a(8)),s=a.n(o),i=a(12),m=a(1),u=a(2),d=a(3),p=a(5),b=Object(n.createContext)({id:"",email:"",displayName:"",role:"",myTickets:[],projects:[]}),g=a(64),E=a(15),f=a(11),h=a.n(f);a(40),a(44),a(63);h.a.initializeApp({apiKey:"AIzaSyBcSu1C4Qdud_a52NOWikVSOj0njkwODpc",authDomain:"bugtrail-v2.firebaseapp.com",databaseURL:"https://bugtrail-v2.firebaseio.com",projectId:"bugtrail-v2",storageBucket:"bugtrail-v2.appspot.com",messagingSenderId:"723885045033",appId:"1:723885045033:web:4eeef384d51bf7c025b338",measurementId:"G-VH49TBGZ9N"});var N=function(){var e=Object(i.a)(s.a.mark((function e(t,a){var n,l,c,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return n=j.doc("users/".concat(t.uid)),e.next=5,n.get();case 5:if(e.sent.exists){e.next=17;break}return l=t.displayName,c=t.email,r=new Date,e.prev=9,e.next=12,n.set(Object(E.a)({displayName:l,email:c,createdAt:r,myTickets:[""]},a));case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(9),console.log("error creating user",e.t0.message);case 17:return e.abrupt("return",n);case 18:case"end":return e.stop()}}),e,null,[[9,14]])})));return function(t,a){return e.apply(this,arguments)}}(),v=h.a.auth(),j=h.a.firestore(),k=h.a.storage(),y=new h.a.auth.GoogleAuthProvider;y.setCustomParameters({prompt:"select_account"});h.a,a(46);var w=function(){var e=Object(n.useState)(""),t=Object(m.a)(e,2),a=t[0],c=t[1],r=Object(n.useState)(""),o=Object(m.a)(r,2),s=o[0],i=o[1],u=Object(n.useState)(),E=Object(m.a)(u,2),f=E[0],N=E[1],v=Object(n.useState)(""),y=Object(m.a)(v,2),w=y[0],O=y[1],x=Object(n.useState)(""),S=Object(m.a)(x,2),C=S[0],T=S[1],P=Object(d.h)().projectId,A=Object(n.useContext)(b);Object(n.useEffect)((function(){j.collection("projects").doc(P).get().then((function(e){T(e.data().name)})).catch((function(e){console.error("Couldn't fetch project name: ",e)}))}),[P]);var D=function(e){var t=e.target,a=t.name,n=t.value;switch(a){case"title":c(n);break;case"description":i(n);break;case"priority":O(n)}};return l.a.createElement("div",{className:"pt-3 pl-2 pr-2 mt-5 mr-3 ml-3",style:{minHeight:"86vh"}},l.a.createElement("h1",{className:"text-center"},"Raising a new defect for: ",C),l.a.createElement("form",{className:"mb-5",onSubmit:function(e){e.preventDefault();var t=Object(g.a)(),n=new Date,l="";if(f){var r=k.ref().child("images/"+f.name).put(f,{contentType:"image/jpeg"});r.on(h.a.storage.TaskEvent.STATE_CHANGED,(function(e){var t=e.bytesTransferred/e.totalBytes*100;switch(console.log("Upload is "+t+"% done"),e.state){case h.a.storage.TaskState.PAUSED:console.log("Upload is paused");break;case h.a.storage.TaskState.RUNNING:console.log("Upload is running")}}),(function(e){console.error("Couldn't upload image: ",e)}),(function(){r.snapshot.ref.getDownloadURL().then((function(e){console.log("File available at",e),l=e})).then((function(){j.collection("tickets").doc(t).set({owner:{id:A.id,displayName:A.displayName,email:A.email},project:{projectId:P,projectName:C},title:a,description:s,imageUrl:l,priority:w,createdAt:n,status:"unassigned",assignee:{id:"",displayName:"",email:""},logs:[{personName:A.displayName,personRole:A.role,timestamp:n,statusChangedTo:"created"}],comments:[]}).then((function(){console.log("Ticket submitted successfully!")})).then((function(){c(""),i(""),O(""),N(void 0)})).catch((function(e){console.error("Error creating ticket: ",e)}))}))}))}else j.collection("tickets").doc(t).set({owner:{id:A.id,displayName:A.displayName,email:A.email},project:{projectId:P,projectName:C},title:a,description:s,imageUrl:l,priority:w,createdAt:n,status:"unassigned",assignee:{id:"",displayName:"",email:""},logs:[{personName:A.displayName,personRole:A.role,timestamp:n,statusChangedTo:"created"}],comments:[]});j.collection("users").doc(A.id).set({myTickets:[].concat(Object(p.a)(A.myTickets),[t])},{merge:!0})}},l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{htmlFor:"defectTitle"},"Title"),l.a.createElement("input",{type:"text",name:"title",className:"form-control",id:"defectTitle",placeholder:"Issue title here...",value:a,onChange:D})),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{htmlFor:"defectDescription"},"Description"),l.a.createElement("textarea",{className:"form-control",name:"description",id:"defectDescription",placeholder:"Write a detailed description of the issue here...",rows:3,value:s,onChange:D})),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{htmlFor:"defectImage"},"Defect Image"),l.a.createElement("input",{type:"file",name:"defectImage",className:"form-control-file",onChange:function(e){e.target.files&&e.target.files[0].size<=3145728?(N(e.target.files?e.target.files[0]:void 0),console.log(f)):(alert("The maximum image size allowed is 3MB"),N(void 0))},id:"defectImage"})),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{htmlFor:"defectPriority"},"Priority Level"),l.a.createElement("select",{className:"form-control",name:"priority",id:"defectPriority",value:w,onChange:D},l.a.createElement("option",null,"--Select--"),l.a.createElement("option",null,"Severe"),l.a.createElement("option",null,"High"),l.a.createElement("option",null,"Medium"),l.a.createElement("option",null,"Low"),l.a.createElement("option",null,"Feature request"))),l.a.createElement("button",{type:"submit",className:"btn btn-dark"},"Submit Defect")))},O=function(){return l.a.createElement("div",{className:"card-footer text-white mt-auto text-center bg-dark"},l.a.createElement("h6",null,"Created by Nikhil Choudhary"),l.a.createElement("p",null,"\xa9 Copyright 2020"))},x=(a(51),Object(d.i)((function(){var e=Object(d.f)(),t=Object(n.useContext)(b);return l.a.createElement("div",{className:"bootstrap-navbar"},l.a.createElement("nav",{className:"navbar fixed-top navbar-expand-lg navbar-dark bg-dark"},l.a.createElement(u.b,{to:"/bugtrail-v3",className:"navbar-brand"},"BUGTRAIL"),l.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation"},l.a.createElement("span",{className:"navbar-toggler-icon"})),l.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarNav"},l.a.createElement("ul",{className:"navbar-nav"},l.a.createElement("li",{className:"nav-item ".concat("/bugtrail-v3"===e.location.pathname?"active":"")},l.a.createElement(u.b,{to:"/bugtrail-v3",className:"nav-link"},"Home ",l.a.createElement("span",{className:"sr-only"},"(current)"))),l.a.createElement("li",{className:"nav-item ".concat("/bugtrail-v3/register-and-login"===e.location.pathname?"active":"")},!t.email&&l.a.createElement(u.b,{to:"/bugtrail-v3/register-and-login",className:"nav-link"},"Login and Register")),l.a.createElement("li",null,t.email&&l.a.createElement("div",{className:"nav-link",style:{cursor:"pointer"},onClick:function(){v.signOut(),e.push("/bugtrail-v3"),window.location.reload()}},"Logout"))),l.a.createElement("span",{className:"navbar-text ml-auto"},t.email?"Hi, ".concat(t.displayName):""))))}))),S=function(){var e=new URLSearchParams(Object(d.g)().search),t=e.get("type"),a=e.get("projectId"),c=Object(n.useState)([]),r=Object(m.a)(c,2),o=r[0],s=r[1],i=Object(n.useContext)(b);return Object(n.useEffect)((function(){s([]);var e=[];j.collection("tickets").orderBy("createdAt","desc").get().then((function(t){t.forEach((function(t){var a=t.data(),n=a.project,l=a.title,c=a.description,r=a.imageUrl,o=a.priority,s=a.status,i=a.owner,m=a.assignee,u=a.createdAt,d=a.logs,p=a.comments;e.push({id:t.id,project:n,title:l,description:c,imageUrl:r,priority:o,status:s,owner:i,assignee:m,createdAt:u,logs:d,comments:p})}))})).then((function(){switch(t){case"all":s(e.filter((function(e){return a?e.project.projectId===a?e:void 0:e})));break;case"my":s(e.filter((function(e){if(e.owner.id===i.id){if(!a)return e;if(e.project.projectId===a)return e}})));break;case"assigned-to-me":s(e.filter((function(e){if(e.assignee.id===i.id){if(!a)return e;if(e.project.projectId===a)return e}})));break;case"unassigned":s(e.filter((function(e){if("unassigned"===e.status){if(!a)return e;if(e.project.projectId===a)return e}})));break;case"fixed":s(e.filter((function(e){if("fixed"===e.status){if(!a)return e;if(e.project.projectId===a)return e}})));break;case"failed":s(e.filter((function(e){if("failed"===e.status){if(!a)return e;if(e.project.projectId===a)return e}})))}})).catch((function(e){console.error("Couldn't fetch tickets: ",e)}))}),[t,i,a]),l.a.createElement("div",{className:"pt-3 pb-3 pl-2 pr-2 mt-5 mr-3 ml-3 mb-5",style:{minHeight:"81vh"}},l.a.createElement("h2",{className:"text-center"},"View Tickets Here"),o.length>0?l.a.createElement("table",{className:"table table-bordered table-striped table-dark mb-5"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",{scope:"col"},"S.No."),l.a.createElement("th",{scope:"col"},"Issue Title"),l.a.createElement("th",{scope:"col"},"Project"),l.a.createElement("th",{scope:"col"},"Issue Priority"),l.a.createElement("th",{scope:"col"},"Status"))),l.a.createElement("tbody",null,o.map((function(e,t){var a;return l.a.createElement("tr",{key:t},l.a.createElement("th",{scope:"row"},t+1),l.a.createElement("td",null,l.a.createElement(u.b,{className:"text-white",to:"/bugtrail-v3/ticket-details/".concat(e.id)},e.title)),l.a.createElement("td",null,(null===(a=e.project)||void 0===a?void 0:a.projectName)?e.project.projectName:""),l.a.createElement("td",null,e.priority),l.a.createElement("td",null,e.status))})))):l.a.createElement("h3",{className:"text-center pt-5"},"No tickets found"))},C=(a(52),function(){var e=Object(n.useContext)(b);return l.a.createElement("div",{className:"pt-3 pb-3 mt-5",style:{minHeight:"86vh"}},e.email?l.a.createElement("div",{className:"card border-dark m-5"},l.a.createElement("h5",{className:"card-header text-white bg-dark"},"User Dashboard"),l.a.createElement("div",{className:"card-body"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-3 col-sm-12"},l.a.createElement("div",{className:"card border-dark mb-3"},l.a.createElement("ul",{className:"list-group list-group-flush"},l.a.createElement("li",{className:"list-group-item"},l.a.createElement(u.b,{className:"link-font",to:"/bugtrail-v3/projects"},"Admin"===e.role?"View All Projects":"View My Projects")),"Admin"===e.role?l.a.createElement("li",{className:"list-group-item"},l.a.createElement(u.b,{className:"link-font",to:"/bugtrail-v3/new-project"},"Create A New Project")):void 0,l.a.createElement("li",{className:"list-group-item"},l.a.createElement(u.b,{className:"link-font",to:"/bugtrail-v3/view-tickets?type=my"},"My Tickets")),l.a.createElement("li",{className:"list-group-item"},l.a.createElement(u.b,{className:"link-font",to:"/bugtrail-v3/view-tickets?type=all"},"All Tickets")),l.a.createElement("li",{className:"list-group-item"},l.a.createElement(u.b,{className:"link-font",to:"/bugtrail-v3/view-tickets?type=assigned-to-me"},"Tickets Assigned To Me")),"Triage"===e.role||"Admin"===e.role?l.a.createElement("li",{className:"list-group-item"},l.a.createElement(u.b,{className:"link-font",to:"/bugtrail-v3/view-tickets?type=unassigned"},"Unassigned Tickets")):null,"Triage"===e.role||"Admin"===e.role?l.a.createElement("li",{className:"list-group-item"},l.a.createElement(u.b,{className:"link-font",to:"/bugtrail-v3/view-tickets?type=fixed"},"Fixed Tickets")):null,"Triage"===e.role||"Admin"===e.role?l.a.createElement("li",{className:"list-group-item"},l.a.createElement(u.b,{className:"link-font",to:"/bugtrail-v3/view-tickets?type=failed"},"Failed Tickets")):null))),l.a.createElement("div",{className:"col-md-9 col-sm-12"},l.a.createElement("div",{className:"card border-dark"},l.a.createElement("h5",{className:"card-header text-white bg-dark"},e.displayName),l.a.createElement("ul",{className:"list-group list-group-flush"},l.a.createElement("li",{className:"list-group-item"},l.a.createElement("span",{className:"badge badge-dark badge-pill"},"User ID")," ",e.id),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("span",{className:"badge badge-dark badge-pill"},"Name")," ",e.displayName),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("span",{className:"badge badge-dark badge-pill"},"Email")," ",e.email),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("span",{className:"badge badge-dark badge-pill"},"Role Assigned")," ",e.role))))))):l.a.createElement("h2",{className:"text-center"},"Welcome to Bugtrail. A bug tracking software. Please register or login to continue."))}),T=(a(53),function(){var e=Object(n.useState)(""),t=Object(m.a)(e,2),a=t[0],c=t[1],r=Object(n.useState)(""),o=Object(m.a)(r,2),s=o[0],i=o[1],u=Object(n.useState)(""),d=Object(m.a)(u,2),E=d[0],f=d[1],h=Object(n.useContext)(b),N=function(e){var t=e.target,a=t.name,n=t.value;switch(a){case"projName":c(n);break;case"projDescription":i(n);break;case"projStatus":f(n)}};return l.a.createElement("div",{className:"pt-5 pb-3 pl-2 pr-2 mt-5 mr-3 ml-3 mb-5",style:{minHeight:"81vh"}},l.a.createElement("h2",{className:"text-center"},"CREATE A NEW PROJECT"),l.a.createElement("form",{className:"mb-5",onSubmit:function(e){e.preventDefault();var t=Object(g.a)(),n=[];j.collection("projects").doc(t).set({name:a,description:s,status:E}).then((function(){j.collection("users").doc(h.id).get().then((function(e){e.exists&&(n=e.data().projects)})).then((function(){j.collection("users").doc(h.id).set({projects:[].concat(Object(p.a)(n),[t])},{merge:!0}).then((function(){console.log("Project created successfully!"),c(""),i(""),f("")})).catch((function(e){console.error("Error writing document: ",e)}))}))})).catch((function(e){console.error("Error writing document: ",e)}))}},l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{htmlFor:"projName"},"Title"),l.a.createElement("input",{type:"text",name:"projName",className:"form-control",id:"projName",placeholder:"Project name here...",value:a,onChange:N})),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{htmlFor:"projDescription"},"Description"),l.a.createElement("textarea",{className:"form-control",name:"projDescription",id:"projDescription",placeholder:"Write a description for your project here...",rows:3,value:s,onChange:N})),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{htmlFor:"projStatus"},"Operational Status"),l.a.createElement("select",{className:"form-control",name:"projStatus",id:"projStatus",value:E,onChange:N},l.a.createElement("option",null,"--Select--"),l.a.createElement("option",null,"Active"),l.a.createElement("option",null,"Inactive"),l.a.createElement("option",null,"Ended"),l.a.createElement("option",null,"Maintenance"))),l.a.createElement("button",{type:"submit",className:"btn btn-dark"},"Create Project")))}),P=(a(54),function(){var e=Object(d.h)().projectId,t=Object(n.useContext)(b),a=Object(n.useState)(!1),c=Object(m.a)(a,2),r=c[0],o=c[1],s=Object(n.useState)(),i=Object(m.a)(s,2),g=i[0],E=i[1],f=Object(n.useState)([]),h=Object(m.a)(f,2),N=h[0],v=h[1],k=Object(n.useState)([]),y=Object(m.a)(k,2),w=y[0],O=y[1],x=Object(n.useState)(""),S=Object(m.a)(x,2),C=S[0],T=S[1],P=Object(n.useState)(0),A=Object(m.a)(P,2),D=A[0],I=A[1],R=Object(n.useState)(0),F=Object(m.a)(R,2),U=F[0],H=F[1],L=Object(n.useState)(0),M=Object(m.a)(L,2),q=M[0],B=M[1],W=Object(n.useState)(0),G=Object(m.a)(W,2),V=G[0],z=G[1],J=Object(n.useState)(0),_=Object(m.a)(J,2),K=_[0],Q=_[1];Object(n.useEffect)((function(){j.collection("projects").doc(e).get().then((function(e){if(e.exists){var t=e.data(),a=t.name,n=t.description,l=t.status;E({id:e.id,name:a,description:n,status:l})}else console.log("No such document!")})).then((function(){v([]),O([]),j.collection("users").get().then((function(t){t.forEach((function(t){var a=t.data(),n=a.displayName,l=a.email,c=a.role,r=a.projects;r.includes(e)?v((function(e){return[].concat(Object(p.a)(e),[{id:t.id,displayName:n,email:l,role:c,projects:r}])})):O((function(e){return[].concat(Object(p.a)(e),[{id:t.id,displayName:n,email:l,role:c,projects:r}])}))}))}))})).then((function(){Q(0),B(0),I(0),H(0),z(0),j.collection("tickets").get().then((function(t){t.forEach((function(t){if(t.data().project.projectId===e)switch(t.data().priority){case"Low":I((function(e){return e+1}));break;case"Medium":H((function(e){return e+1}));break;case"High":B((function(e){return e+1}));break;case"Severe":z((function(e){return e+1}));break;case"Feature request":Q((function(e){return e+1}))}}))})).catch((function(e){console.error("Ticket priorities couldn't be fetched: ",e)}))})).catch((function(e){console.log("Error getting document:",e)}))}),[e,r]);var Z=function(){o((function(e){return!e}))};return l.a.createElement("div",{className:"pt-3 pb-3 pl-2 pr-2 mt-5 mr-3 ml-3 mb-5",style:{minHeight:"81vh"}},l.a.createElement("h2",{className:"text-center"},"Project Details Page"),l.a.createElement("div",{className:"card border-dark mb-3"},l.a.createElement("div",{className:"card-header text-white bg-dark"},"Name: ",null===g||void 0===g?void 0:g.name),l.a.createElement("div",{className:"card-body"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-3 col-sm-12"},l.a.createElement("div",{className:"card border-dark mb-3"},l.a.createElement("ul",{className:"list-group list-group-flush"},l.a.createElement("li",{className:"list-group-item"},l.a.createElement(u.b,{className:"text-decoration-none text-dark",to:"/bugtrail-v3/new-defect/".concat(e)},"Raise a new Defect")),l.a.createElement("li",{className:"list-group-item"},l.a.createElement(u.b,{className:"text-decoration-none text-dark",to:"/bugtrail-v3/view-tickets/?projectId=".concat(e,"&type=all")},"View all tickets for:-",l.a.createElement("div",{style:{textTransform:"uppercase",fontWeight:"bold"}},null===g||void 0===g?void 0:g.name))),"Admin"===t.role?l.a.createElement("li",{className:"list-group-item"},"Add people to the project",l.a.createElement("form",{onSubmit:function(t){var a;t.preventDefault(),j.collection("users").doc(C).get().then((function(e){e.exists?a=e.data().projects:console.log("No such document!")})).then((function(){j.collection("users").doc(C).set({projects:[].concat(Object(p.a)(a),[e])},{merge:!0}).then((function(){console.log("projects updated successfully!")})).then((function(){Z()})).catch((function(e){console.error("couldn't update projects!",e)}))})).catch((function(e){console.error("Error getting document: ",e)}))}},l.a.createElement("div",{className:"form-group mt-3"},l.a.createElement("select",{className:"form-control",value:C,onChange:function(e){T(e.target.value)},name:"addMembers"},l.a.createElement("option",null,"--Select One--"),w.map((function(e){return l.a.createElement("option",{value:e.id,key:e.id},e.displayName,"@",e.email)})))),l.a.createElement("button",{type:"submit",className:"btn btn-dark"},"Add Member"))):void 0))),l.a.createElement("div",{className:"col-md-9 col-sm-12"},l.a.createElement("div",{className:"card border-dark"},l.a.createElement("ul",{className:"list-group list-group-flush"},l.a.createElement("li",{className:"list-group-item"},l.a.createElement("span",{className:"badge badge-pill badge-dark"},"ID")," ",null===g||void 0===g?void 0:g.id),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("span",{className:"badge badge-pill badge-dark"},"Descrition")," ",null===g||void 0===g?void 0:g.description),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("span",{className:"badge badge-pill badge-dark"},"status")," ",null===g||void 0===g?void 0:g.status),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("span",{className:"badge badge-pill badge-dark"},"Severe")," ",V),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("span",{className:"badge badge-pill badge-dark"},"High")," ",q),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("span",{className:"badge badge-pill badge-dark"},"Medium")," ",U),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("span",{className:"badge badge-pill badge-dark"},"Low")," ",D),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("span",{className:"badge badge-pill badge-dark"},"Feature Request")," ",K))))))),l.a.createElement("table",{className:"table table-striped table-bordered table-dark mb-5"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",{scope:"col"},"S.No."),l.a.createElement("th",{scope:"col"},"Project Members"),l.a.createElement("th",{scope:"col"},"Members Emails"),l.a.createElement("th",{scope:"col"},"Roles"))),l.a.createElement("tbody",null,N.map((function(t,a){return l.a.createElement("tr",{key:a},l.a.createElement("th",{scope:"row"},a+1),l.a.createElement("td",null,t.displayName),l.a.createElement("td",null,t.email),l.a.createElement("td",null,t.role),l.a.createElement("td",{className:"text-center"},l.a.createElement("button",{className:"btn btn-danger",onClick:(n=t.id,function(t){t.preventDefault();var a=[];j.collection("users").doc(n).get().then((function(t){t.exists&&((a=t.data().projects)&&a.includes(e)?a.splice(a.indexOf(e),1):console.log("User isn't a part of this project!"))})).then((function(){console.log("Entered 2nd then block"),j.collection("users").doc(n).set({projects:a},{merge:!0}).then((function(){console.log("project removed successfully!")})).then((function(){Z()})).catch((function(e){console.error("couldn't remove project!",e)}))})).catch((function(e){console.error("Couldn't remove user from project: ",e)}))})},"Remove")));var n})))))}),A=(a(55),function(){var e=Object(n.useState)([]),t=Object(m.a)(e,2),a=t[0],c=t[1],r=Object(n.useContext)(b);return Object(n.useEffect)((function(){j.collection("projects").get().then((function(e){e.forEach((function(e){("Admin"===r.role||r.projects.includes(e.id))&&c((function(t){return[].concat(Object(p.a)(t),[{id:e.id,name:e.data().name,description:e.data().description,status:e.data().status}])}))}))}))}),[r.projects,r.role]),l.a.createElement("div",{className:"pt-5 pb-3 pl-2 pr-2 mt-5 mr-3 ml-3 mb-5",style:{minHeight:"81vh"}},l.a.createElement("h2",{className:"text-center"},"PROJECTS PAGE"),l.a.createElement("table",{className:"table table-bordered table-striped table-dark mb-5"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",{scope:"col"},"S.No."),l.a.createElement("th",{scope:"col"},"Project Name"),l.a.createElement("th",{scope:"col"},"Project Status"))),l.a.createElement("tbody",null,a.map((function(e,t){return l.a.createElement("tr",{key:t},l.a.createElement("th",{scope:"row"},t+1),l.a.createElement("td",null,l.a.createElement(u.b,{className:"text-white text-decoration-none",to:"/bugtrail-v3/project-details/".concat(e.id)},e.name)),l.a.createElement("td",null,e.status))})))))}),D=(a(56),a(16)),I=(a(57),function(){var e=Object(d.f)(),t=Object(n.useState)({email:"developer@nikhil.com",password:"12345678"}),a=Object(m.a)(t,2),c=a[0],r=a[1],o=c.email,u=c.password,p=function(e){var t=e.target,a=t.name,n=t.value;r((function(e){return Object(E.a)({},e,Object(D.a)({},a,n))}))},b=function(){var t=Object(i.a)(s.a.mark((function t(a){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.prev=1,t.next=4,v.signInWithEmailAndPassword(o,u);case 4:r({email:"",password:""}),e.push("/bugtrail-v3"),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),console.error("Couldn't login user: ",t.t0);case 11:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}();return l.a.createElement("div",{className:"text-center mb-5 mt-5"},l.a.createElement("form",{className:"form-signin",onSubmit:b},l.a.createElement("img",{className:"mb-4",src:"https://banner2.cleanpng.com/20180526/ux/kisspng-software-bug-undocumented-feature-computer-softwar-5b093b61afe799.6982676615273316817205.jpg",alt:"bugtrail",width:"72",height:"72"}),l.a.createElement("h1",{className:"h3 mb-3 font-weight-normal"},"Please Login"),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{htmlFor:"loginEmail",className:"sr-only"},"Email address"),l.a.createElement("input",{type:"email",name:"email",id:"loginEmail",className:"form-control",placeholder:"Email address",value:o,onChange:p,required:!0})),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{htmlFor:"loginPassword",className:"sr-only"},"Password"),l.a.createElement("input",{type:"password",name:"password",id:"loginPassword",className:"form-control",placeholder:"Password",value:u,onChange:p,required:!0})),l.a.createElement("div",{className:"checkbox mb-3"},l.a.createElement("label",null,l.a.createElement("input",{type:"checkbox",value:"remember-me"})," Remember me")),l.a.createElement("button",{className:"btn btn-lg btn-dark btn-block",type:"submit"},"Login")))}),R=(a(58),function(){var e=Object(d.f)(),t=Object(n.useState)({fName:"Developer",lName:"Schwarz",role:"Developer",email:"developer@nikhil.com",password:"12345678",confirmPassword:"12345678"}),a=Object(m.a)(t,2),c=a[0],r=a[1],o=c.fName,u=c.lName,p=c.role,b=c.email,g=c.password,f=c.confirmPassword,h=function(e){var t=e.target,a=t.name,n=t.value;r((function(e){return Object(E.a)({},e,Object(D.a)({},a,n))}))},j=function(){var t=Object(i.a)(s.a.mark((function t(a){var n,l;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("Entered handleSubmit"),a.preventDefault(),g===f){t.next=5;break}return alert("Passwords don't match!"),t.abrupt("return");case 5:return t.prev=5,t.next=8,v.createUserWithEmailAndPassword(b,g);case 8:return n=t.sent,l=n.user,t.next=12,N(l,{displayName:"".concat(o," ").concat(u),role:p,createdProjects:[""],projects:[""]});case 12:r({fName:"",lName:"",role:"",email:"",password:"",confirmPassword:""}),e.push("/bugtrail-v3"),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(5),console.error("Error creating user: ",t.t0);case 19:case"end":return t.stop()}}),t,null,[[5,16]])})));return function(e){return t.apply(this,arguments)}}();return l.a.createElement("div",{className:"text-center mb-5 mt-5"},l.a.createElement("form",{className:"form-signin",onSubmit:j},l.a.createElement("img",{className:"mb-4",src:"https://banner2.cleanpng.com/20180526/ux/kisspng-software-bug-undocumented-feature-computer-softwar-5b093b61afe799.6982676615273316817205.jpg",alt:"bugtrail",width:"72",height:"72"}),l.a.createElement("h1",{className:"h3 mb-3 font-weight-normal"},"Please Register"),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{htmlFor:"firstName",className:"sr-only"},"First Name"),l.a.createElement("input",{type:"text",name:"fName",id:"firstName",className:"form-control",placeholder:"First Name",value:o,onChange:h,required:!0})),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{htmlFor:"lastName",className:"sr-only"},"Last Name"),l.a.createElement("input",{type:"text",name:"lName",id:"lastName",className:"form-control",placeholder:"Last Name",value:u,onChange:h,required:!0})),l.a.createElement("div",{className:"form-group"},l.a.createElement("select",{className:"form-control",name:"role",id:"role",value:p,onChange:h},l.a.createElement("option",null,"--Select--"),l.a.createElement("option",null,"Developer"),l.a.createElement("option",null,"Triage"),l.a.createElement("option",null,"Tester"))),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{htmlFor:"registerEmail",className:"sr-only"},"Email address"),l.a.createElement("input",{type:"email",name:"email",id:"registerEmail",className:"form-control",placeholder:"Email address",onChange:h,value:b,required:!0})),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{htmlFor:"registerPassword",className:"sr-only"},"Password"),l.a.createElement("input",{type:"password",name:"password",id:"registerPassword",className:"form-control",placeholder:"Password",value:g,onChange:h,required:!0})),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{htmlFor:"inputConfirmPassword",className:"sr-only"},"Confirm Password"),l.a.createElement("input",{type:"password",name:"confirmPassword",id:"inputConfirmPassword",className:"form-control",placeholder:"Confirm Password",value:f,onChange:h,required:!0})),l.a.createElement("div",{className:"checkbox mb-3"},l.a.createElement("label",null,l.a.createElement("input",{type:"checkbox",value:"remember-me"})," Remember me")),l.a.createElement("button",{className:"btn btn-lg btn-dark btn-block",type:"submit"},"Register")))}),F=function(){return l.a.createElement("div",{className:"pt-5 pl-3 pr-3 pb-5",style:{minHeight:"91vh"}},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 col-sm-12"},l.a.createElement(I,null)),l.a.createElement("div",{className:"col-md-6 col-sm-12"},l.a.createElement(R,null))))},U=function(){var e=Object(d.h)().ticketId,t=Object(n.useContext)(b),a=Object(n.useState)(!0),c=Object(m.a)(a,2),r=c[0],o=c[1],s=Object(n.useState)(""),i=Object(m.a)(s,2),u=i[0],g=i[1],E=Object(n.useState)([]),f=Object(m.a)(E,2),h=f[0],N=f[1],v=Object(n.useState)({id:"",displayName:"",email:""}),k=Object(m.a)(v,2),y=k[0],w=k[1],O=Object(n.useState)(""),x=Object(m.a)(O,2),S=x[0],C=x[1],T=Object(n.useState)(""),P=Object(m.a)(T,2),A=P[0],D=P[1],I=Object(n.useState)({id:"",project:{projectId:"",projectName:""},title:"",description:"",imageUrl:"",priority:"",status:"",owner:{displayName:"",email:"",id:""},assignee:{displayName:"",email:"",id:""},createdAt:"",logs:[],comments:[]}),R=Object(m.a)(I,2),F=R[0],U=R[1];Object(n.useEffect)((function(){j.collection("tickets").doc(e).get().then((function(e){if(e.exists){var t=e.data(),a=t.project,n=t.title,l=t.description,c=t.imageUrl,r=t.priority,o=t.status,s=t.owner,i=t.assignee,m=t.createdAt,u=t.logs,d=t.comments;U({id:e.id,project:a,title:n,description:l,imageUrl:c,priority:r,status:o,owner:s,assignee:i,createdAt:m.toDate().toString(),logs:u,comments:d}),w(i),C(o),g(a.projectId)}else console.log("No such document!")})).then((function(){j.collection("users").get().then((function(e){N([]),e.forEach((function(e){e.data().projects.includes(u)&&N((function(t){return[].concat(Object(p.a)(t),[{id:e.id,displayName:e.data().displayName,email:e.data().email}])}))}))})).catch((function(e){console.error("couldn't fetch the users list: ",e)}))})).catch((function(e){console.error("Error getting document:",e)}))}),[e,u,r]);var H=function(){o((function(e){return!e}))},L=function(e){C(e.target.value)},M=function(a){a.preventDefault();var n=[];j.collection("tickets").doc(e).get().then((function(e){e.exists&&(n=e.data().logs)})).then((function(){j.collection("tickets").doc(e).set({status:S,logs:[].concat(Object(p.a)(n),[{personName:t.displayName,personRole:t.role,timestamp:new Date,statusChangedTo:S}])},{merge:!0}).then((function(){console.log("Status changed successfully!")})).then((function(){H()})).catch((function(e){console.error("Error changing status: ",e)}))})).catch((function(e){console.error("Couldn't fetch logs array: ",e)}))};return l.a.createElement("div",{className:"pt-3 pb-3 pl-2 pr-2 mt-5 mr-3 ml-3 mb-5",style:{minHeight:"81vh"}},l.a.createElement("h2",{className:"text-center"},"Ticket Details Page"),l.a.createElement("div",{className:"card border-dark mb-5"},l.a.createElement("ul",{className:"list-group"},l.a.createElement("li",{className:"list-group-item"},l.a.createElement("span",{className:"badge badge-dark"},"ID")," ",e),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("span",{className:"badge badge-dark"},"Project Name")," ",F.project.projectName),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("span",{className:"badge badge-dark"},"Title")," ",F.title),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("span",{className:"badge badge-dark"},"Description")," ",F.description),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("span",{className:"badge badge-dark"},"Priority")," ",F.priority),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("div",{className:"mb-3"},l.a.createElement("span",{className:"badge badge-dark"},"Screenshot")),l.a.createElement("img",{src:F.imageUrl,alt:"defect screenshot",className:"img-fluid"})),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("span",{className:"badge badge-dark"},"Created At")," ",F.createdAt),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("span",{className:"badge badge-dark"},"Owner")," ",F.owner.displayName),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("span",{className:"badge badge-dark"},"Asignee")," ",F.assignee.displayName,"Triage"===t.role||"Admin"===t.role?l.a.createElement("div",{className:"mt-3"},l.a.createElement("select",{className:"text-center",name:"assignee",id:"assignee",value:y.displayName,onChange:function(e){h.forEach((function(t){t.displayName===e.target.value&&w(t)}))}},l.a.createElement("option",{className:""},"--Select--"),h.map((function(e,t){return l.a.createElement("option",{key:t},e.displayName)})))," ",l.a.createElement("button",{className:"btn btn-sm btn-dark",onClick:function(a){a.preventDefault();var n=y?"assigned":"unassigned",l=[];j.collection("tickets").doc(e).get().then((function(e){e.exists&&(l=e.data().logs)})).then((function(){j.collection("tickets").doc(e).set({assignee:y,status:n,logs:[].concat(Object(p.a)(l),[{personName:t.displayName,personRole:t.role,timestamp:new Date,statusChangedTo:n}])},{merge:!0}).then((function(){console.log("Status changed successfully!")})).then((function(){H()})).catch((function(e){console.error("Error changing status: ",e)}))})).catch((function(e){console.error("Couldn't fetch logs array: ",e)}))}},"Change Assignee")):""),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("span",{className:"badge badge-dark"},"Status")," ",F.status,function(){switch(t.role){case"Tester":return F.assignee.displayName===t.displayName?l.a.createElement("div",{className:"mt-3"},l.a.createElement("select",{className:"text-center",name:"status",id:"status",value:S,onChange:L},l.a.createElement("option",{className:""},"--Select--"),l.a.createElement("option",null,"passed"),l.a.createElement("option",null,"failed"))," ",l.a.createElement("button",{className:"btn btn-sm btn-dark",onClick:M},"Change Status")):"";case"Triage":return l.a.createElement("div",{className:"mt-3"},l.a.createElement("select",{className:"text-center",name:"status",id:"status",value:S,onChange:L},l.a.createElement("option",{className:""},"--Select--"),l.a.createElement("option",null,"assigned"),l.a.createElement("option",null,"duplicate"),l.a.createElement("option",null,"rejected"),l.a.createElement("option",null,"closed"),l.a.createElement("option",null,"in-testing"),l.a.createElement("option",null,"tested"),l.a.createElement("option",null,"passed"),l.a.createElement("option",null,"failed"))," ",l.a.createElement("button",{className:"btn btn-sm btn-dark",onClick:M},"Change Status"));case"Admin":return l.a.createElement("div",{className:"mt-3"},l.a.createElement("select",{className:"text-center",name:"status",id:"status",value:S,onChange:L},l.a.createElement("option",{className:""},"--Select--"),l.a.createElement("option",null,"assigned"),l.a.createElement("option",null,"duplicate"),l.a.createElement("option",null,"rejected"),l.a.createElement("option",null,"closed"),l.a.createElement("option",null,"in-testing"),l.a.createElement("option",null,"tested"),l.a.createElement("option",null,"in-progress"),l.a.createElement("option",null,"on-hold"),l.a.createElement("option",null,"fixed"))," ",l.a.createElement("button",{className:"btn btn-sm btn-dark",onClick:M},"Change Status"));case"Developer":return F.assignee.displayName===t.displayName?l.a.createElement("div",{className:"mt-3"},l.a.createElement("select",{className:"text-center",name:"status",id:"exampleFormControlSelect1",value:S,onChange:L},l.a.createElement("option",{className:""},"--Select--"),l.a.createElement("option",null,"in-progress"),l.a.createElement("option",null,"on-hold"),l.a.createElement("option",null,"fixed"))," ",l.a.createElement("button",{className:"btn btn-sm btn-dark",onClick:M},"Change Status")):""}}()))),l.a.createElement("h4",{className:"text-center"},"Ticket change history"),l.a.createElement("table",{className:"table table-striped table-bordered table-dark"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",{scope:"col"},"S.No."),l.a.createElement("th",{scope:"col"},"Person"),l.a.createElement("th",{scope:"col"},"Role"),l.a.createElement("th",{scope:"col"},"Changed the status to"),l.a.createElement("th",{scope:"col"},"on Date"))),l.a.createElement("tbody",null,F.logs.map((function(e,t){return l.a.createElement("tr",{key:t},l.a.createElement("th",{scope:"row"},t+1),l.a.createElement("td",null,e.personName),l.a.createElement("td",null,e.personRole),l.a.createElement("td",null,e.statusChangedTo),l.a.createElement("td",null,e.timestamp.toDate().toString()))})))),l.a.createElement("h4",{className:"text-center"},"Ticket comment history"),l.a.createElement("table",{className:"table table-striped table-bordered table-dark"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",{scope:"col"},"S.No."),l.a.createElement("th",{scope:"col"},"Person"),l.a.createElement("th",{scope:"col"},"Role"),l.a.createElement("th",{scope:"col"},"Comment"))),l.a.createElement("tbody",null,F.comments.map((function(e,t){return l.a.createElement("tr",{key:t},l.a.createElement("th",{scope:"row"},t+1),l.a.createElement("td",null,e.personName),l.a.createElement("td",null,e.personRole),l.a.createElement("td",null,e.comment))})))),l.a.createElement("form",null,l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{htmlFor:"comment"},"Add Comment"),l.a.createElement("textarea",{className:"form-control",name:"comment",id:"comment",value:A,onChange:function(e){D(e.target.value)},rows:4})),l.a.createElement("button",{className:"btn btn-dark",onClick:function(a){a.preventDefault();var n=[];j.collection("tickets").doc(e).get().then((function(e){e.exists&&(n=e.data().comments)})).then((function(){j.collection("tickets").doc(e).set({comments:[].concat(Object(p.a)(n),[{personName:t.displayName,personRole:t.role,timestamp:new Date,comment:A}])},{merge:!0}).then((function(){console.log("Successfully added the comment."),H(),D("")})).catch((function(e){console.error("Couldn't add the comment: ",e)}))})).catch((function(e){console.error("Couldn't fetch comments array: ",e)}))}},"Submit Comment")))},H=function(){var e=Object(n.useState)({id:"",email:"",displayName:"",role:"",myTickets:[],projects:[]}),t=Object(m.a)(e,2),a=t[0],c=t[1];return Object(n.useEffect)((function(){var e=v.onAuthStateChanged(function(){var e=Object(i.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=5;break}return e.next=3,N(t,void 0);case 3:null===(a=e.sent)||void 0===a||a.onSnapshot((function(e){var t,a,n,l,r;c({id:e.id,email:null===(t=e.data())||void 0===t?void 0:t.email,displayName:null===(a=e.data())||void 0===a?void 0:a.displayName,role:null===(n=e.data())||void 0===n?void 0:n.role,myTickets:null===(l=e.data())||void 0===l?void 0:l.myTickets,projects:null===(r=e.data())||void 0===r?void 0:r.projects})}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());return function(){e()}}),[]),l.a.createElement("div",null,l.a.createElement(b.Provider,{value:a},l.a.createElement(u.a,null,l.a.createElement(x,null),l.a.createElement(d.c,null,l.a.createElement(d.a,{exact:!0,path:"/bugtrail-v3",component:C}),l.a.createElement(d.a,{exact:!0,path:"/bugtrail-v3/register-and-login",component:F}),l.a.createElement(d.a,{exact:!0,path:"/bugtrail-v3/new-defect/:projectId",component:w}),l.a.createElement(d.a,{exact:!0,path:"/bugtrail-v3/new-project",component:T}),l.a.createElement(d.a,{path:"/bugtrail-v3/view-tickets",component:S}),l.a.createElement(d.a,{exact:!0,path:"/bugtrail-v3/ticket-details/:ticketId",component:U}),l.a.createElement(d.a,{exact:!0,path:"/bugtrail-v3/projects",component:A}),l.a.createElement(d.a,{exact:!0,path:"/bugtrail-v3/project-details/:projectId",component:P})))),l.a.createElement(O,null))};a(59),a(60),a(29);r.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(H,null)),document.getElementById("root"))}},[[33,1,2]]]);
//# sourceMappingURL=main.5c66cd85.chunk.js.map